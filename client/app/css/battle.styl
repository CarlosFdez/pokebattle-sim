outline-text(clr = #000)
  text-shadow 0 1px 0 clr, 0 -1px 0 clr,
              -1px 0 0 clr, 1px 0 0 clr

divide(a, b)
  a / b

button-bg(clr)
  clr          = lighten(clr, 50%)
  dark         = darken(clr, 10%)
  darker-dark  = darken(dark, 20%)
  dark-clr     = darken(clr, 20%)
  darker-clr   = darken(clr, 50%)
  darkest-clr  = darken(darker-clr, 20%)
  btn-clr      = darken(darkest-clr, 30%)
  background   linear-gradient(top, clr, dark-clr)
  border       1px solid darker-clr
  border-color rgba(0, 0, 0, .1), rgba(0, 0, 0, .2), rgba(0, 0, 0, .3)
  color        btn-clr
  &:hover
    background linear-gradient(top, dark, darker-dark)
    border-color darkest-clr
    color darken(btn-clr, 20%)
    text-shadow   0 -1px 0 rgba(255, 255, 255, .10)

$padding = 10px
$battle-width = 600px
$pane-width = $battle-width + $padding + $padding

.battle_window .chat
  left $pane-width

.battle
  position absolute
  top 0
  left 0
  bottom 0
  width $pane-width
  box-sizing border-box
  background $body-color
  padding $padding
  h2
    font-size      0.6875em
    text-transform uppercase
    letter-spacing 1px
    border-bottom  1px solid rgba(0, 0, 0, .10)
    line-height normal
  .battle_container
    position relative
    width $battle-width
    height 300px
    background url("/images/battle_bg.jpg")
    narrow-font()
  .battle_user_info
    background rgba(0, 20, 64, .5)
    position absolute
    top 0
    left 0
    right 0
    bottom 0
    .left
      bottom 20px
      left 0
    .right
      top 20px
      right 0
    .left, .right
      position absolute
      width 100px
      color #fff
      text-align center
      outline-text()
      font-size 13px
      .pokemon_icon
        top 0
        left 0
  .battle_pane
    position      absolute
    width         400px
    height        300px
    top           0
    left          100px
    background    url("/images/battle_bg.jpg") center center
    .pokemon
      &.bottom
        .pokemon-info
          bottom      30%
          left        188px
        .sprite
          img
            image-rendering         -moz-crisp-edges
            image-rendering         -o-crisp-edges
            image-rendering         -webkit-optimize-contrast
            -ms-interpolation-mode  nearest-neighbor
          bottom   0
          left     0
          width    188px
          height   @width
          &.fade
            left    @left - 20px
            opacity .3
      &.top
        .pokemon-info
          top         20%
          right       188px
        .sprite
          top      30px
          right    20px
          width    96px
          height   @width
          &.fade
            right   @right - 20px
            opacity .3

    .pokemon-info
      position      absolute
      width         144px
      height        3px
      border        1px solid #fff
      border-radius 2px
      box-shadow    0 0 0 1px #000
      background    rgba(0, 8, 32, .5)
      .hp, .hp-red
        position    absolute
        top         0
        left        0
        bottom      0
        width       100%
        transition  width .4s cubic-bezier(0, 1, .5, 1)
      .hp-red
        background  #C00
        transition  width .4s linear 1s
      .hp
        background  #0f0
      .pokemon-name, .pokemon-meta
        position absolute
        bottom 100%
        color #fff
        outline-text()
      .pokemon-name
        left 0
        font-weight 700
      .pokemon-meta
        right 0
        font-size 75%
      .pokemon-level
        color #EFA532
      .pokemon-effects
        position absolute
        top 7px
        color #fff
        .pokemon-effect
          font-size .625em
          float left
          border-radius 3px
          background #333
          color #fff
          padding 0 4px
          &.sleep
            background #535
          &.burn
            background #c33
          &.freeze
            background #38b
          &.paralyze
            background #b93
          &.poison, &.toxic
            background #b3b
    .sprite
      position absolute
      overflow hidden
      transition .5s ease-out
  .pokemon
    position absolute
    width 100%
    height 100%
    top 0
    left 0
    overflow hidden

  .pokeball
    position absolute
    background url("http://i.imgur.com/AdbmXdf.jpg") -133px -10px
    transition opacity .25s ease-in

.button
  clearfix()
  button-bg(#eee)
  display       inline-block
  height        32px
  line-height   @height
  border-radius 4px
  margin-bottom 6px
  padding       0 10px
  cursor        pointer
  color         #333
  text-shadow   0 -1px 0 rgba(255, 255, 255, .25)
  box-shadow    inset 0 1px 0 rgba(255,255,255,.25), 0 1px 2px rgba(0,0,0,.25)
  .main_text
    narrow-font()
    font-weight 700
    float       left
  .meta_info
    font-size   12px
    float       right
    font-family "Helvetica Neue", sans-serif
  &.normal
    button-bg($normal)
  &.fire
    button-bg($fire)
  &.water
    button-bg($water)
  &.electric
    button-bg($electric)
  &.grass
    button-bg($grass)
  &.ice
    button-bg($ice)
  &.fighting
    button-bg($fighting)
  &.poison
    button-bg($poison)
  &.ground
    button-bg($ground)
  &.flying
    button-bg($flying)
  &.psychic
    button-bg($psychic)
  &.bug
    button-bg($bug)
  &.rock
    button-bg($rock)
  &.ghost
    button-bg($ghost)
  &.dragon
    button-bg($dragon)
  &.dark
    button-bg($dark)
  &.steel
    button-bg($steel)
  &.disabled, &.disabled:hover
    background  #444
    border-color #8A8171
    cursor      default
    color       #888
    text-shadow none

.moves
  .button
    display block
    float none
    margin 0 0 5px

.switches
  .button
    display block
    float none

.gender
  &.gender_female
    color #EA597A
  &.gender_male
    color #62CBB0

.pokemon_icon
  position    relative
  width       32px
  height      @width
  display     block
  margin      0 auto
  top         -3px
  left        -4px
  background url("http://i.imgur.com/UUGozoG.png") top left
  &.fainted
    opacity 0.5

.battle_teams
  text-align center
  width 80%
  margin 0 auto
  normal-font()
  li
    position relative
  .gender
    position absolute
    top 0
    right 2px
    font-size .75em
    text-shadow 0 1px 0 #333
  .level
    position absolute
    bottom 0
    right 2px
    font-size .75em
    line-height @font-size
    outline-text(#fff)
    narrow-font()

.battle_team_preview
  background #eee
  padding 10px
  border-radius 4px
  margin 10px 0
  border 1px solid #aaa

  .submit_arrangement
    margin 10px 0 0

  .team_pokemon
    position relative
    width 32px
    height @width
    margin 0 auto

  .arrange_team
    user-select none
    overflow hidden
    li
      cursor move

  .lead_text
    font-size .8125em
    min-height 0

  .pokemon_icon
    top 0
    left 0

  .sortable-placeholder
    border 1px dashed #ccc
    background none
    float left
    // TODO: This should have the span2 style attached
    width 41.296875px
    height 40px
    margin-left 2.564102564102564%

  // :first-child pseudo-classes don't work well with jquery.sortable
  .first-child
    margin-left 0

  .unstyled
    margin 0
